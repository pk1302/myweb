<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Possible Studio Booking (User Only)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
  <style>body { font-family: 'Inter', sans-serif; }</style>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
</head>
<body class="bg-zinc-900 text-white">
  <div id="root"></div>
  <script>
    // --- Firebase Config ---
    const firebaseConfig = {
      apiKey: "AIzaSyCzSeK0Mare4CtM4pFqwSAO_YmLcQEGJOo",
      authDomain: "studio-booking-608cc.firebaseapp.com",
      databaseURL: "https://studio-booking-608cc-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "studio-booking-608cc",
      storageBucket: "studio-booking-608cc.appspot.com",
      messagingSenderId: "464295194306",
      appId: "1:464295194306:web:d8ec45509b0e4241a9955b",
      measurementId: "G-LZEK0QJBMG"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const { useState, useEffect, useMemo, useCallback } = React;

    // --- Pricing Data ---
    const PRICING_PLANS = [
      { id: 'basic', name: 'Basic Studio', price: 2000, description: 'Just the space. Bring your own gear and create freely.', features: ['Studio Space Access'] },
      { id: 'standard', name: 'Standard Package', price: 3500, description: 'A complete setup for most projects, cameraman included.', features: ['Studio Space Access', '2 Professional Cameras', 'Standard Lighting Kit', '2 Shure Microphones', 'Dedicated Cameraman'] },
      { id: 'premium', name: 'Premium Package', price: 4500, description: 'For complex shoots requiring multiple angles and full support.', features: ['Studio Space Access', '3 Professional Cameras', 'Advanced Lighting Kit', '2 Shure Microphones', 'Dedicated Cameraman'] },
    ];
    const HOURLY_SLOTS = Array.from({ length: 14 }, (_, i) => {
      const hour = i + 9;
      return `${hour < 10 ? '0' : ''}${hour}:00`;
    });

    function CheckIcon() {
      return (
        React.createElement("svg", { className: "h-6 w-6 text-yellow-400", xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
          React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: "2", d: "M5 13l4 4L19 7" })
        )
      );
    }

    // --- Cancellation Modal ---
    function CancellationModal({ onClose }) {
      return (
        React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50" },
          React.createElement("div", { className: "bg-white max-w-md w-full p-8 rounded-xl text-center shadow-2xl" },
            React.createElement("h2", { className: "text-2xl font-bold mb-4 text-red-600" }, "Booking Cancelled"),
            React.createElement("p", { className: "mb-2 text-gray-800" }, "Your booking has been cancelled."),
            React.createElement("p", { className: "mb-2 text-gray-800" }, "For more details, please call: ",
              React.createElement("a", { href: "tel:9994858927", className: "text-blue-600 font-semibold" }, "9994858927")
            ),
            React.createElement("p", { className: "mb-4 text-gray-800" }, "If you have already made a payment, your refund will be processed within 24 hours."),
            React.createElement("button", {
              onClick: onClose,
              className: "mt-2 px-6 py-2 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition-colors"
            }, "Close")
          )
        )
      );
    }

    // --- BookingForm with cancellation detection ---
    function BookingForm({ plan, onBack }) {
      const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
      const [startTime, setStartTime] = useState('');
      const [endTime, setEndTime] = useState('');
      const [name, setName] = useState('');
      const [phone, setPhone] = useState('');
      const [formError, setFormError] = useState('');
      const [bookingId, setBookingId] = useState('');
      const [bookingStatus, setBookingStatus] = useState('');
      const [showCancelModal, setShowCancelModal] = useState(false);

      // Listen for booking status if we have a bookingId
      useEffect(() => {
        if (!bookingId) return;
        const ref = db.ref('bookings/' + bookingId);
        ref.on('value', snapshot => {
          const data = snapshot.val();
          if (data && data.status) {
            setBookingStatus(data.status);
            if (data.status === 'cancelled') setShowCancelModal(true);
          }
        });
        return () => ref.off();
      }, [bookingId]);

      function handleSubmit(e) {
        e.preventDefault();
        setFormError('');
        if (!name || !phone || !date || !startTime || !endTime) {
          setFormError('Please fill all fields.');
          return;
        }
        if (!/^[6-9]\d{9}$/.test(phone)) {
          setFormError('Please enter a valid 10-digit Indian phone number.');
          return;
        }
        const booking = {
          name, phone, plan: plan.name, date, startTime, endTime,
          status: 'pending', createdAt: new Date().toISOString()
        };
        db.ref('bookings').push(booking).then(ref => {
          setBookingId(ref.key);
        });
      }

      if (showCancelModal) {
        return React.createElement(CancellationModal, { onClose: () => { setShowCancelModal(false); onBack(); } });
      }

      if (bookingId) {
        return (
          React.createElement("div", { className: "max-w-lg mx-auto bg-zinc-800 rounded-xl shadow-lg p-8 border border-zinc-700 text-center mt-10" },
            React.createElement("h2", { className: "text-2xl font-bold mb-4" }, "Booking Status"),
            bookingStatus === "confirmed"
              ? React.createElement("span", { className: "text-green-400 font-bold" }, "Your booking is confirmed!")
              : bookingStatus === "pending"
                ? React.createElement("span", { className: "text-yellow-400 font-bold" }, "Waiting for admin confirmation...")
                : null,
            React.createElement("div", { className: "mt-4" },
              React.createElement("button", { className: "bg-zinc-700 px-6 py-2 rounded font-bold mt-4", onClick: onBack }, "Back to Plans")
            )
          )
        );
      }

      return (
        React.createElement("div", { className: "max-w-lg mx-auto bg-zinc-800 rounded-xl shadow-lg p-8 border border-zinc-700 mt-10" },
          React.createElement("h2", { className: "text-2xl font-bold mb-6 text-white" }, `Book ${plan.name}`),
          React.createElement("form", { onSubmit: handleSubmit, autoComplete: "off" },
            React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "Your Name"),
            React.createElement("input", { className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: name, onChange: e => setName(e.target.value) }),
            React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "Phone Number"),
            React.createElement("input", {
              className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white",
              value: phone,
              onChange: e => setPhone(e.target.value.replace(/\D/g, '').slice(0,10)),
              maxLength: 10,
              pattern: "[6-9][0-9]{9}",
              inputMode: "numeric",
              placeholder: "10-digit mobile"
            }),
            React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "Date"),
            React.createElement("input", { type: "date", className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: date, onChange: e => setDate(e.target.value), min: new Date().toISOString().split('T')[0] }),
            React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "Start Time"),
            React.createElement("select", { className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: startTime, onChange: e => setStartTime(e.target.value) },
              React.createElement("option", { value: "" }, "Select start time"),
              HOURLY_SLOTS.slice(0, -1).map(time =>
                React.createElement("option", { key: time, value: time }, time)
              )
            ),
            React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "End Time"),
            React.createElement("select", { className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: endTime, onChange: e => setEndTime(e.target.value) },
              React.createElement("option", { value: "" }, "Select end time"),
              HOURLY_SLOTS.map(time =>
                React.createElement("option", { key: time, value: time }, time)
              )
            ),
            formError && React.createElement("div", { className: "mb-4 text-red-400" }, formError),
            React.createElement("div", { className: "flex space-x-4" },
              React.createElement("button", { type: "submit", className: "bg-yellow-500 text-zinc-900 font-bold py-2 px-6 rounded hover:bg-yellow-600 transition-colors" }, "Book Now"),
              React.createElement("button", { type: "button", className: "bg-zinc-600 text-white font-bold py-2 px-6 rounded hover:bg-zinc-700 transition-colors", onClick: onBack }, "Back")
            )
          )
        )
      );
    }

    function Pricing({ onSelectPlan }) {
      return (
        React.createElement("section", { className: "py-20 sm:py-28 bg-zinc-900" },
          React.createElement("div", { className: "container mx-auto px-4 sm:px-6 lg:px-8" },
            React.createElement("div", { className: "text-center mb-16" },
              React.createElement("h2", { className: "text-3xl sm:text-4xl lg:text-5xl font-bold tracking-tight text-white" }, "Flexible Pricing for Every Creator"),
              React.createElement("p", { className: "mt-4 max-w-3xl mx-auto text-lg text-gray-400" },
                "Choose a standard package or call us to build a custom one. All prices are inclusive of taxes."
              )
            ),
            React.createElement("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 items-stretch" },
              PRICING_PLANS.map((plan) =>
                React.createElement("div", { key: plan.id, className: "flex flex-col h-full bg-zinc-800 rounded-2xl shadow-xl border border-zinc-700 p-8" },
                  React.createElement("h3", { className: "text-2xl font-bold text-white" }, plan.name),
                  React.createElement("p", { className: "mt-4 text-gray-400 flex-grow" }, plan.description),
                  React.createElement("div", { className: "mt-6" },
                    React.createElement("span", { className: "text-5xl font-extrabold text-white" }, `â‚¹${plan.price.toLocaleString('en-IN')}`),
                    React.createElement("span", { className: "text-lg font-medium text-gray-400" }, "/hour")
                  ),
                  React.createElement("ul", { className: "mt-8 space-y-4" },
                    plan.features.map((feature, index) =>
                      React.createElement("li", { key: index, className: "flex items-start" },
                        React.createElement("div", { className: "flex-shrink-0" }, React.createElement(CheckIcon)),
                        React.createElement("p", { className: "ml-3 text-base text-gray-300" }, feature)
                      )
                    )
                  ),
                  React.createElement("div", { className: "mt-auto pt-8" },
                    React.createElement("button", {
                      onClick: () => onSelectPlan(plan),
                      className: "w-full bg-yellow-500 text-slate-900 font-bold py-3 px-6 rounded-lg hover:bg-yellow-600 transition-colors"
                    }, "Select Plan")
                  )
                )
              )
            )
          )
        )
      );
    }

    function App() {
      const [selectedPlan, setSelectedPlan] = useState(null);

      return (
        React.createElement("div", null,
          React.createElement("div", { className: "text-center py-8" },
            React.createElement("h1", { className: "text-3xl font-bold text-yellow-400 mb-2" }, "Possible Studio Booking"),
            React.createElement("p", { className: "text-gray-400" }, "Book your studio slot and check your booking status.")
          ),
          !selectedPlan
            ? React.createElement(Pricing, { onSelectPlan: setSelectedPlan })
            : React.createElement(BookingForm, {
                plan: selectedPlan,
                onBack: () => setSelectedPlan(null)
              })
        )
      );
    }

    ReactDOM.render(
      React.createElement(App),
      document.getElementById('root')
    );
  </script>
</body>
</html>
