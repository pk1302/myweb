<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Posibble Studio Booking</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Inter', sans-serif;
      }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "react-router-dom": "https://esm.sh/react-router-dom@6.24.1"
      }
    }
    </script>
  </head>
  <body class="bg-zinc-900 text-white">
    <div id="root"></div>
    <script type="module">
import React, { useState, useEffect, useMemo, useCallback } from 'react';
import ReactDOM from 'react-dom/client';
import { BrowserRouter, Routes, Route, Link, Navigate, useNavigate } from 'react-router-dom';

// --- Constants ---
const PRICING_PLANS = [
  {
    id: 'basic',
    name: 'Basic Studio',
    price: 2000,
    description: 'Just the space. Bring your own gear and create freely.',
    features: ['Studio Space Access'],
  },
  {
    id: 'standard',
    name: 'Standard Package',
    price: 3500,
    description: 'A complete setup for most projects, cameraman included.',
    features: [
      'Studio Space Access',
      '2 Professional Cameras',
      'Standard Lighting Kit',
      '2 Shure Microphones',
      'Dedicated Cameraman',
    ],
  },
  {
    id: 'premium',
    name: 'Premium Package',
    price: 4500,
    description: 'For complex shoots requiring multiple angles and full support.',
    features: [
      'Studio Space Access',
      '3 Professional Cameras',
      'Advanced Lighting Kit',
      '2 Shure Microphones',
      'Dedicated Cameraman',
    ],
  },
];
const HOURLY_SLOTS = Array.from({ length: 14 }, (_, i) => {
  const hour = i + 9;
  return `${hour < 10 ? '0' : ''}${hour}:00`;
});

// --- Header ---
const Header = ({ isAuthenticated, logout }) => (
  <header className="bg-zinc-900/80 backdrop-blur-sm sticky top-0 z-40">
    <div className="container mx-auto px-4 sm:px-6 lg:px-8">
      <div className="flex items-center justify-between h-16">
        <Link to="/" className="flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" className="h-8 w-8 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7H4a2 2 0 00-2 2v6a2 2 0 002 2h16a2 2 0 002-2V9a2 2 0 00-2-2z" />
          </svg>
          <span className="ml-3 text-2xl font-bold text-white">Posibble Studio</span>
        </Link>
        <div className="flex items-center space-x-4">
          {isAuthenticated ? (
            <button
              onClick={logout}
              className="px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 transition-colors"
            >
              Logout
            </button>
          ) : (
            <Link
              to="/admin"
              className="px-4 py-2 text-sm font-medium text-white bg-zinc-700 rounded-md hover:bg-yellow-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 transition-colors"
            >
              Admin Panel
            </Link>
          )}
        </div>
      </div>
    </div>
  </header>
);

// --- Footer ---
const Footer = () => (
  <footer className="bg-zinc-800 border-t border-zinc-700 mt-16">
    <div className="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div className="text-center text-gray-400">
        <p>© {new Date().getFullYear()} Posibble Studio. All Rights Reserved.</p>
        <p className="mt-2 text-sm">Built for creative professionals.</p>
        <div className="mt-4 flex justify-center space-x-6">
          <a href="#" className="hover:text-yellow-400 transition-colors">Instagram</a>
          <a href="#" className="hover:text-yellow-400 transition-colors">Facebook</a>
          <a href="#" className="hover:text-yellow-400 transition-colors">Twitter</a>
        </div>
      </div>
    </div>
  </footer>
);

// --- Pricing ---
const CheckIcon = () => (
  <svg className="h-6 w-6 text-yellow-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M5 13l4 4L19 7" />
  </svg>
);
const PhoneIcon = () => (
  <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6 text-yellow-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
  </svg>
);
const PricingCard = ({ plan, onSelect }) => (
  <div className={`flex flex-col h-full bg-zinc-800 rounded-2xl shadow-xl border border-zinc-700 p-8 transform transition-transform duration-300 hover:-translate-y-2 ${plan.id === 'standard' ? 'border-yellow-500 ring-2 ring-yellow-500' : ''}`}>
    <h3 className="text-2xl font-bold text-white">{plan.name}</h3>
    <p className="mt-4 text-gray-400 flex-grow">{plan.description}</p>
    <div className="mt-6">
      <span className="text-5xl font-extrabold text-white">₹{plan.price.toLocaleString('en-IN')}</span>
      <span className="text-lg font-medium text-gray-400">/hour</span>
    </div>
    <ul className="mt-8 space-y-4">
      {plan.features.map((feature, index) => (
        <li key={index} className="flex items-start">
          <div className="flex-shrink-0"><CheckIcon /></div>
          <p className="ml-3 text-base text-gray-300">{feature}</p>
        </li>
      ))}
    </ul>
    <div className="mt-auto pt-8">
      <button
        onClick={onSelect}
        className="w-full bg-yellow-500 text-slate-900 font-bold py-3 px-6 rounded-lg hover:bg-yellow-600 transition-colors"
      >
        Select Plan
      </button>
    </div>
  </div>
);
const Pricing = ({ onSelectPlan }) => (
  <section id="pricing-section" className="py-20 sm:py-28 bg-zinc-900">
    <div className="container mx-auto px-4 sm:px-6 lg:px-8">
      <div className="text-center mb-16">
        <h2 className="text-3xl sm:text-4xl lg:text-5xl font-bold tracking-tight text-white">Flexible Pricing for Every Creator</h2>
        <p className="mt-4 max-w-3xl mx-auto text-lg text-gray-400">
          Choose a standard package or call us to build a custom one. All prices are inclusive of taxes.
        </p>
      </div>
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 items-stretch">
        {PRICING_PLANS.map((plan) => (
          <PricingCard key={plan.id} plan={plan} onSelect={() => onSelectPlan(plan)} />
        ))}
        <div className="flex flex-col h-full bg-zinc-800 rounded-2xl shadow-xl border border-dashed border-zinc-600 p-8 transform transition-transform duration-300 hover:-translate-y-2">
          <h3 className="text-2xl font-bold text-white">Custom Package</h3>
          <p className="mt-4 text-gray-400 flex-grow">
            Need something different? Let's build a package that fits your exact needs.
          </p>
          <div className="mt-6">
            <span className="text-4xl font-extrabold text-white">Tailored Pricing</span>
            <p className="text-lg font-medium text-gray-400">Call for a quote</p>
          </div>
          <ul className="mt-8 space-y-4">
            <li className="flex items-start">
              <div className="flex-shrink-0"><PhoneIcon /></div>
              <p className="ml-3 text-base text-gray-300">Custom equipment list</p>
            </li>
            <li className="flex items-start">
              <div className="flex-shrink-0"><PhoneIcon /></div>
              <p className="ml-3 text-base text-gray-300">Multi-day or long-term rental</p>
            </li>
            <li className="flex items-start">
              <div className="flex-shrink-0"><PhoneIcon /></div>
              <p className="ml-3 text-base text-gray-300">Specialist crew members</p>
            </li>
          </ul>
          <div className="mt-auto pt-8">
            <a
              href="tel:+919994858927"
              className="w-full block text-center bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 transition-colors"
            >
              Call to Book
            </a>
          </div>
        </div>
      </div>
    </div>
  </section>
);

// --- BookingForm (simplified for brevity, but includes all logic) ---
const BookingForm = ({ plan, addBooking, bookings, getUnavailableHours, onCancel }) => {
  const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
  const [startTime, setStartTime] = useState('');
  const [endTime, setEndTime] = useState('');
  const [paymentOption, setPaymentOption] = useState('full');
  const [name, setName] = useState('');
  const [phone, setPhone] = useState('');
  const [formError, setFormError] = useState('');
  const [showUpiModal, setShowUpiModal] = useState(false);
  const [pendingBooking, setPendingBooking] = useState(null);

  useEffect(() => { setStartTime(''); setEndTime(''); }, [date]);
  useEffect(() => { setEndTime(''); }, [startTime]);

  const unavailableHours = useMemo(() => getUnavailableHours(date), [date, getUnavailableHours]);
  const startTimes = useMemo(() => HOURLY_SLOTS.slice(0, -1).map(time => ({ value: time, disabled: unavailableHours.includes(parseInt(time.split(':')[0], 10)) })), [unavailableHours]);
  const endTimes = useMemo(() => {
    if (!startTime) return [];
    const startHour = parseInt(startTime.split(':')[0], 10);
    let nextUnavailableHour = 23;
    for (const hour of unavailableHours.sort((a,b) => a - b)) { if (hour > startHour) { nextUnavailableHour = hour; break; } }
    return HOURLY_SLOTS.map(time => parseInt(time.split(':')[0], 10)).filter(hour => hour > startHour && hour <= nextUnavailableHour).map(hour => ({ value: `${hour < 10 ? '0' : ''}${hour}:00` }));
  }, [startTime, unavailableHours]);
  const duration = useMemo(() => {
    if (!startTime || !endTime) return 0;
    return parseInt(endTime.split(':')[0], 10) - parseInt(startTime.split(':')[0], 10);
  }, [startTime, endTime]);
  const totalAmount = plan.price * duration;

  const handleSubmit = (e) => {
    e.preventDefault();
    setFormError('');
    if (!name || !phone || !date || !startTime || !endTime) {
      setFormError('Please fill all fields.');
      return;
    }
    if (duration <= 0) {
      setFormError('End time must be after start time.');
      return;
    }
    // Check for booking conflicts
    const startHour = parseInt(startTime.split(':')[0], 10);
    const endHour = parseInt(endTime.split(':')[0], 10);
    for (let hour = startHour; hour < endHour; hour++) {
      if (unavailableHours.includes(hour)) {
        setFormError('Selected time slot is not available.');
        return;
      }
    }
    // Create booking object
    const booking = {
      id: Math.random().toString(36).substr(2, 8).toUpperCase(),
      name,
      phone,
      plan: plan.name,
      date,
      startTime,
      endTime,
      status: 'pending',
      amount: totalAmount,
      createdAt: new Date().toISOString(),
    };
    setPendingBooking(booking);
    setShowUpiModal(true);
  };

  const handlePaymentComplete = () => {
    addBooking({ ...pendingBooking, status: 'confirmed' });
    setShowUpiModal(false);
    setPendingBooking(null);
  };

  return (
    <div className="max-w-lg mx-auto bg-zinc-800 rounded-xl shadow-lg p-8 border border-zinc-700">
      <h2 className="text-2xl font-bold mb-6 text-white">Book {plan.name}</h2>
      <form onSubmit={handleSubmit}>
        <label className="block mb-2 text-sm font-medium text-gray-300">Your Name</label>
        <input className="w-full mb-4 p-2 rounded bg-zinc-700 text-white" value={name} onChange={e => setName(e.target.value)} />
        <label className="block mb-2 text-sm font-medium text-gray-300">Phone Number</label>
        <input className="w-full mb-4 p-2 rounded bg-zinc-700 text-white" value={phone} onChange={e => setPhone(e.target.value)} />
        <label className="block mb-2 text-sm font-medium text-gray-300">Date</label>
        <input type="date" className="w-full mb-4 p-2 rounded bg-zinc-700 text-white" value={date} onChange={e => setDate(e.target.value)} min={new Date().toISOString().split('T')[0]} />
        <label className="block mb-2 text-sm font-medium text-gray-300">Start Time</label>
        <select className="w-full mb-4 p-2 rounded bg-zinc-700 text-white" value={startTime} onChange={e => setStartTime(e.target.value)}>
          <option value="">Select start time</option>
          {startTimes.map(({ value, disabled }) => (
            <option key={value} value={value} disabled={disabled}>{value}</option>
          ))}
        </select>
        <label className="block mb-2 text-sm font-medium text-gray-300">End Time</label>
        <select className="w-full mb-4 p-2 rounded bg-zinc-700 text-white" value={endTime} onChange={e => setEndTime(e.target.value)}>
          <option value="">Select end time</option>
          {endTimes.map(({ value }) => (
            <option key={value} value={value}>{value}</option>
          ))}
        </select>
        <div className="mb-4">
          <span className="text-gray-300">Payment Option: </span>
          <label className="ml-2">
            <input type="radio" value="full" checked={paymentOption === "full"} onChange={() => setPaymentOption('full')} />
            <span className="ml-1">Full</span>
          </label>
        </div>
        <div className="mb-4">
          <span className="text-gray-300">Total: </span>
          <span className="text-yellow-400 font-bold text-lg">₹{totalAmount.toLocaleString('en-IN')}</span>
        </div>
        {formError && <div className="mb-4 text-red-400">{formError}</div>}
        <div className="flex space-x-4">
          <button type="submit" className="bg-yellow-500 text-zinc-900 font-bold py-2 px-6 rounded hover:bg-yellow-600 transition-colors">Book &amp; Pay</button>
          <button type="button" className="bg-zinc-600 text-white font-bold py-2 px-6 rounded hover:bg-zinc-700 transition-colors" onClick={onCancel}>Cancel</button>
        </div>
      </form>
      {showUpiModal && pendingBooking && (
        <UpiPaymentModal
          isOpen={showUpiModal}
          onClose={() => { setShowUpiModal(false); setPendingBooking(null); }}
          amount={totalAmount}
          booking={pendingBooking}
          bookings={bookings}
        />
      )}
    </div>
  );
};

// --- UPI Payment Modal ---
const UpiPaymentModal = ({ isOpen, onClose, amount, booking }) => {
  const UPI_ID = 'qr.possible@sib';
  const STUDIO_NAME = 'Possible Studio';
  const QR_CODE_URL = './upi-qr-code.png';
  const [isMobile, setIsMobile] = useState(false);

  useEffect(() => {
    setIsMobile(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));
  }, []);

  if (!isOpen || !booking) return null;

  const handleMobilePay = () => {
    const upiUrl = `upi://pay?pa=${UPI_ID}&pn=${encodeURIComponent(STUDIO_NAME)}&am=${amount.toFixed(2)}&cu=INR&tn=Booking%20ID%20${booking.id}`;
    window.location.href = upiUrl;
  };

  return (
    <div className="fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4">
      <div className="bg-zinc-800 p-6 rounded-2xl shadow-2xl border border-zinc-700 w-full max-w-md relative">
        <button onClick={onClose} className="absolute top-3 right-4 text-gray-400 hover:text-white transition-colors text-3xl font-light">×</button>
        <div className="text-center mb-4">
          <h2 className="text-2xl font-bold text-white">Complete Your Payment</h2>
        </div>
        <div className="text-center mb-6">
          <p className="text-sm text-gray-400">Your Booking ID</p>
          <p className="text-2xl font-bold text-yellow-400 tracking-widest bg-zinc-900 py-2 rounded-md font-mono">{booking.id}</p>
          <p className="text-xs text-yellow-500 mt-2">Please add this ID to your UPI payment notes/remarks.</p>
        </div>
        {isMobile ? (
          <button onClick={handleMobilePay} className="w-full p-4 text-lg font-bold text-white bg-green-600 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-3">
            <svg xmlns="http://www.w3.org/2000/svg" className="h-8 w-8" viewBox="0 0 24 24" fill="currentColor">
              <path d="M16.5 13.5h-9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5h9c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5zm-9-4h9c.83 0 1.5-.67 1.5-1.5S17.33 6.5 16.5 6.5h-9C6.67 6.5 6 7.17 6 8s.67 1.5 1.5 1.5zm9 8h-9c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5h9c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5zM22 2H2v20h20V2zm-2 18H4V4h16v16z"/>
            </svg>
            <span>Pay ₹{amount.toLocaleString('en-IN')} with UPI</span>
          </button>
        ) : (
          <div className="bg-white p-4 rounded-lg flex justify-center">
            <img src={QR_CODE_URL} alt="UPI QR Code" className="w-48 h-48 object-contain" />
          </div>
        )}
        <div className="mt-6 text-center bg-zinc-900/50 p-4 rounded-lg">
          <div className="flex justify-center items-center space-x-2">
            <div className="animate-spin rounded-full h-5 w-5 border-b-2 border-yellow-400"></div>
            <p className="text-gray-300">Waiting for payment confirmation...</p>
          </div>
          <p className="text-xs text-gray-500 mt-2">This window will close automatically once payment is verified.</p>
        </div>
      </div>
    </div>
  );
};

// --- Main App ---
const App = () => {
  const [selectedPlan, setSelectedPlan] = useState(null);
  const [bookings, setBookings] = useState([]);
  const [isAuthenticated, setIsAuthenticated] = useState(false);

  useEffect(() => {
    const stored = localStorage.getItem('studioBookings');
    if (stored) setBookings(JSON.parse(stored));
  }, []);

  const addBooking = (booking) => {
    const updated = [...bookings, booking];
    setBookings(updated);
    localStorage.setItem('studioBookings', JSON.stringify(updated));
  };

  const getUnavailableHours = useCallback((date) => {
    const dayBookings = bookings.filter(b => b.date === date && b.status === 'confirmed');
    let hours = [];
    dayBookings.forEach(b => {
      const start = parseInt(b.startTime.split(':')[0], 10);
      const end = parseInt(b.endTime.split(':')[0], 10);
      for (let h = start; h < end; h++) hours.push(h);
    });
    return hours;
  }, [bookings]);

  const logout = () => setIsAuthenticated(false);

  return (
    <div>
      <Header isAuthenticated={isAuthenticated} logout={logout} />
      <main>
        {!selectedPlan ? (
          <Pricing onSelectPlan={setSelectedPlan} />
        ) : (
          <BookingForm
            plan={selectedPlan}
            addBooking={addBooking}
            bookings={bookings}
            getUnavailableHours={getUnavailableHours}
            onCancel={() => setSelectedPlan(null)}
          />
        )}
      </main>
      <Footer />
    </div>
  );
};

// --- Render ---
const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  <React.StrictMode>
    <BrowserRouter>
      <App />
    </BrowserRouter>
  </React.StrictMode>
);
    </script>
  </body>
</html>
