<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Studio Booking (Admin Panel Enhanced)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
  <style>body { font-family: 'Inter', sans-serif; }</style>
  <!-- Firebase compat SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <!-- React UMD -->
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/react-router-dom@5.3.4/umd/react-router-dom.min.js"></script>
</head>
<body class="bg-zinc-900 text-white">
  <div id="root"></div>
  <script>
    // --- Firebase Config ---
    const firebaseConfig = {
      apiKey: "AIzaSyCzSeK0Mare4CtM4pFqwSAO_YmLcQEGJOo",
      authDomain: "studio-booking-608cc.firebaseapp.com",
      databaseURL: "https://studio-booking-608cc-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "studio-booking-608cc",
      storageBucket: "studio-booking-608cc.appspot.com",
      messagingSenderId: "464295194306",
      appId: "1:464295194306:web:d8ec45509b0e4241a9955b",
      measurementId: "G-LZEK0QJBMG"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // --- React setup ---
    const { useState, useEffect, useMemo, useCallback } = React;
    const { BrowserRouter, Route, Switch, Link, useHistory, Redirect, useLocation } = ReactRouterDOM;

    // --- Booking CRUD with Firebase ---
    function createBooking(booking) {
      return db.ref('bookings').push(booking);
    }
    function updateBooking(id, updates) {
      return db.ref('bookings/' + id).update(updates);
    }
    function deleteBooking(id) {
      return db.ref('bookings/' + id).remove();
    }
    function listenBookings(callback) {
      const ref = db.ref('bookings');
      ref.on('value', snapshot => {
        const val = snapshot.val() || {};
        const bookings = Object.entries(val).map(([id, data]) => ({ id, ...data }));
        callback(bookings);
      });
      return () => ref.off();
    }

    // --- UI Components ---
    const PRICING_PLANS = [
      { id: 'basic', name: 'Basic Studio', price: 2000, description: 'Just the space. Bring your own gear and create freely.', features: ['Studio Space Access'] },
      { id: 'standard', name: 'Standard Package', price: 3500, description: 'A complete setup for most projects, cameraman included.', features: ['Studio Space Access', '2 Professional Cameras', 'Standard Lighting Kit', '2 Shure Microphones', 'Dedicated Cameraman'] },
      { id: 'premium', name: 'Premium Package', price: 4500, description: 'For complex shoots requiring multiple angles and full support.', features: ['Studio Space Access', '3 Professional Cameras', 'Advanced Lighting Kit', '2 Shure Microphones', 'Dedicated Cameraman'] },
    ];
    const HOURLY_SLOTS = Array.from({ length: 14 }, (_, i) => {
      const hour = i + 9;
      return `${hour < 10 ? '0' : ''}${hour}:00`;
    });

    function Header({ isAuthenticated, logout }) {
      const location = useLocation();
      return (
        React.createElement("header", { className: "bg-zinc-900/80 backdrop-blur-sm sticky top-0 z-40" },
          React.createElement("div", { className: "container mx-auto px-4 sm:px-6 lg:px-8" },
            React.createElement("div", { className: "flex items-center justify-between h-16" },
              React.createElement(Link, { to: "/", className: "flex items-center", style: { cursor: "pointer" } },
                React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: "h-8 w-8 text-yellow-400", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
                  React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7H4a2 2 0 00-2 2v6a2 2 0 002 2h16a2 2 0 002-2V9a2 2 0 00-2-2z" })
                ),
                React.createElement("span", { className: "ml-3 text-2xl font-bold text-white" }, "Posibble Studio")
              ),
              React.createElement("div", { className: "flex items-center space-x-4" },
                isAuthenticated && location.pathname === "/admin" ? (
                  React.createElement("button", {
                    onClick: logout,
                    className: "px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 transition-colors"
                  }, "Logout")
                ) : (
                  React.createElement(Link, {
                    to: "/admin",
                    className: "px-4 py-2 text-sm font-medium text-white bg-zinc-700 rounded-md hover:bg-yellow-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 transition-colors"
                  }, "Admin Panel")
                )
              )
            )
          )
        )
      );
    }
    function Footer() {
      return (
        React.createElement("footer", { className: "bg-zinc-800 border-t border-zinc-700 mt-16" },
          React.createElement("div", { className: "container mx-auto px-4 sm:px-6 lg:px-8 py-8" },
            React.createElement("div", { className: "text-center text-gray-400" },
              React.createElement("p", null, `© ${new Date().getFullYear()} Posibble Studio. All Rights Reserved.`),
              React.createElement("p", { className: "mt-2 text-sm" }, "Built for creative professionals."),
              React.createElement("div", { className: "mt-4 flex justify-center space-x-6" },
                React.createElement("a", { href: "#", className: "hover:text-yellow-400 transition-colors" }, "Instagram"),
                React.createElement("a", { href: "#", className: "hover:text-yellow-400 transition-colors" }, "Facebook"),
                React.createElement("a", { href: "#", className: "hover:text-yellow-400 transition-colors" }, "Twitter")
              )
            )
          )
        )
      );
    }
    function CheckIcon() {
      return (
        React.createElement("svg", { className: "h-6 w-6 text-yellow-400", xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
          React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: "2", d: "M5 13l4 4L19 7" })
        )
      );
    }
    function PhoneIcon() {
      return (
        React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: "h-6 w-6 text-yellow-400", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
          React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" })
        )
      );
    }
    function PricingCard({ plan, onSelect }) {
      return (
        React.createElement("div", { className: `flex flex-col h-full bg-zinc-800 rounded-2xl shadow-xl border border-zinc-700 p-8 transform transition-transform duration-300 hover:-translate-y-2 ${plan.id === 'standard' ? 'border-yellow-500 ring-2 ring-yellow-500' : ''}` },
          React.createElement("h3", { className: "text-2xl font-bold text-white" }, plan.name),
          React.createElement("p", { className: "mt-4 text-gray-400 flex-grow" }, plan.description),
          React.createElement("div", { className: "mt-6" },
            React.createElement("span", { className: "text-5xl font-extrabold text-white" }, `₹${plan.price.toLocaleString('en-IN')}`),
            React.createElement("span", { className: "text-lg font-medium text-gray-400" }, "/hour")
          ),
          React.createElement("ul", { className: "mt-8 space-y-4" },
            plan.features.map((feature, index) =>
              React.createElement("li", { key: index, className: "flex items-start" },
                React.createElement("div", { className: "flex-shrink-0" }, React.createElement(CheckIcon)),
                React.createElement("p", { className: "ml-3 text-base text-gray-300" }, feature)
              )
            )
          ),
          React.createElement("div", { className: "mt-auto pt-8" },
            React.createElement("button", {
              onClick: onSelect,
              className: "w-full bg-yellow-500 text-slate-900 font-bold py-3 px-6 rounded-lg hover:bg-yellow-600 transition-colors"
            }, "Select Plan")
          )
        )
      );
    }
    function Pricing({ onSelectPlan }) {
      return (
        React.createElement("section", { id: "pricing-section", className: "py-20 sm:py-28 bg-zinc-900" },
          React.createElement("div", { className: "container mx-auto px-4 sm:px-6 lg:px-8" },
            React.createElement("div", { className: "text-center mb-16" },
              React.createElement("h2", { className: "text-3xl sm:text-4xl lg:text-5xl font-bold tracking-tight text-white" }, "Flexible Pricing for Every Creator"),
              React.createElement("p", { className: "mt-4 max-w-3xl mx-auto text-lg text-gray-400" },
                "Choose a standard package or call us to build a custom one. All prices are inclusive of taxes."
              )
            ),
            React.createElement("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 items-stretch" },
              PRICING_PLANS.map((plan) =>
                React.createElement(PricingCard, { key: plan.id, plan, onSelect: () => onSelectPlan(plan) })
              ),
              React.createElement("div", { className: "flex flex-col h-full bg-zinc-800 rounded-2xl shadow-xl border border-dashed border-zinc-600 p-8 transform transition-transform duration-300 hover:-translate-y-2" },
                React.createElement("h3", { className: "text-2xl font-bold text-white" }, "Custom Package"),
                React.createElement("p", { className: "mt-4 text-gray-400 flex-grow" }, "Need something different? Let's build a package that fits your exact needs."),
                React.createElement("div", { className: "mt-6" },
                  React.createElement("span", { className: "text-4xl font-extrabold text-white" }, "Tailored Pricing"),
                  React.createElement("p", { className: "text-lg font-medium text-gray-400" }, "Call for a quote")
                ),
                React.createElement("ul", { className: "mt-8 space-y-4" },
                  React.createElement("li", { className: "flex items-start" },
                    React.createElement("div", { className: "flex-shrink-0" }, React.createElement(PhoneIcon)),
                    React.createElement("p", { className: "ml-3 text-base text-gray-300" }, "Custom equipment list")
                  ),
                  React.createElement("li", { className: "flex items-start" },
                    React.createElement("div", { className: "flex-shrink-0" }, React.createElement(PhoneIcon)),
                    React.createElement("p", { className: "ml-3 text-base text-gray-300" }, "Multi-day or long-term rental")
                  ),
                  React.createElement("li", { className: "flex items-start" },
                    React.createElement("div", { className: "flex-shrink-0" }, React.createElement(PhoneIcon)),
                    React.createElement("p", { className: "ml-3 text-base text-gray-300" }, "Specialist crew members")
                  )
                ),
                React.createElement("div", { className: "mt-auto pt-8" },
                  React.createElement("a", {
                    href: "tel:+919994858927",
                    className: "w-full block text-center bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 transition-colors"
                  }, "Call to Book")
                )
              )
            )
          )
        )
      );
    }

    // --- BookingForm: (use previous answer with confirmation message) ---
    // ...Paste BookingForm from previous answer here...

    // --- UpiPaymentModal: (same as before) ---
    // ...Paste UpiPaymentModal from previous answer here...

    // --- AdminPanel: Enhanced with edit/cancel for confirmed bookings ---
    function AdminPanel({ isAuthenticated, setIsAuthenticated }) {
      const [password, setPassword] = useState('');
      const [loginError, setLoginError] = useState('');
      const [bookings, setBookings] = useState([]);
      const [editBooking, setEditBooking] = useState(null);
      const [adminMsg, setAdminMsg] = useState(null);

      useEffect(() => {
        return listenBookings(setBookings);
      }, []);

      function handleLogin(e) {
        e.preventDefault();
        if (password === 'admin123') {
          setIsAuthenticated(true);
          setLoginError('');
        } else {
          setLoginError('Incorrect password');
        }
      }

      function handleStatus(id, status) {
        updateBooking(id, { status }).then(() => {
          setAdminMsg(`Booking ${status === "confirmed" ? "confirmed" : "cancelled"} successfully.`);
          setTimeout(() => setAdminMsg(null), 3000);
        });
      }

      function handleEditSave(updated) {
        updateBooking(updated.id, {
          date: updated.date,
          startTime: updated.startTime,
          endTime: updated.endTime,
          plan: updated.plan,
        }).then(() => {
          setAdminMsg("Booking updated successfully.");
          setEditBooking(null);
          setTimeout(() => setAdminMsg(null), 3000);
        });
      }

      function handleCancel(id) {
        updateBooking(id, { status: "cancelled" }).then(() => {
          setAdminMsg("Booking cancelled.");
          setTimeout(() => setAdminMsg(null), 3000);
        });
      }

      if (!isAuthenticated) {
        return (
          React.createElement("div", { className: "max-w-sm mx-auto mt-16 bg-zinc-800 p-8 rounded-xl shadow-lg border border-zinc-700" },
            React.createElement("h2", { className: "text-xl font-bold mb-4" }, "Admin Login"),
            React.createElement("form", { onSubmit: handleLogin },
              React.createElement("input", {
                type: "password",
                placeholder: "Admin password",
                className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white",
                value: password,
                onChange: e => setPassword(e.target.value)
              }),
              loginError && React.createElement("div", { className: "text-red-400 mb-2" }, loginError),
              React.createElement("button", { type: "submit", className: "w-full bg-yellow-500 text-zinc-900 font-bold py-2 px-6 rounded hover:bg-yellow-600 transition-colors" }, "Login")
            )
          )
        );
      }

      // --- Edit Booking Modal ---
      if (editBooking) {
        return React.createElement(EditBookingModal, {
          booking: editBooking,
          onSave: handleEditSave,
          onCancel: () => setEditBooking(null)
        });
      }

      return (
        React.createElement("div", { className: "container mx-auto px-4 sm:px-6 lg:px-8 py-8" },
          React.createElement("h2", { className: "text-2xl font-bold mb-6 text-white" }, "All Bookings"),
          adminMsg && React.createElement("div", { className: "mb-4 p-4 bg-green-800 text-green-200 rounded" }, adminMsg),
          bookings.length === 0
            ? React.createElement("div", { className: "text-gray-400" }, "No bookings yet.")
            : React.createElement("table", { className: "w-full text-sm bg-zinc-800 rounded-lg overflow-hidden" },
                React.createElement("thead", null,
                  React.createElement("tr", { className: "bg-zinc-700 text-yellow-400" },
                    React.createElement("th", { className: "p-2" }, "Name"),
                    React.createElement("th", { className: "p-2" }, "Phone"),
                    React.createElement("th", { className: "p-2" }, "Plan"),
                    React.createElement("th", { className: "p-2" }, "Date"),
                    React.createElement("th", { className: "p-2" }, "Time"),
                    React.createElement("th", { className: "p-2" }, "Amount"),
                    React.createElement("th", { className: "p-2" }, "Paid"),
                    React.createElement("th", { className: "p-2" }, "Status"),
                    React.createElement("th", { className: "p-2" }, "Action")
                  )
                ),
                React.createElement("tbody", null,
                  bookings.slice().reverse().map(b =>
                    React.createElement("tr", { key: b.id, className: b.status === "cancelled" ? "bg-red-900 text-red-200" : b.status === "pending" ? "bg-zinc-700" : "bg-zinc-800" },
                      React.createElement("td", { className: "p-2" }, b.name),
                      React.createElement("td", { className: "p-2" }, b.phone),
                      React.createElement("td", { className: "p-2" }, b.plan),
                      React.createElement("td", { className: "p-2" }, b.date),
                      React.createElement("td", { className: "p-2" }, `${b.startTime} - ${b.endTime}`),
                      React.createElement("td", { className: "p-2" }, `₹${b.amount}`),
                      React.createElement("td", { className: "p-2" }, `₹${b.paid}`),
                      React.createElement("td", { className: "p-2" },
                        b.status === "confirmed"
                          ? React.createElement("span", { className: "text-green-400" }, "Confirmed")
                          : b.status === "pending"
                            ? React.createElement("span", { className: "text-yellow-400" }, "Pending")
                            : React.createElement("span", { className: "text-red-400" }, "Cancelled")
                      ),
                      React.createElement("td", { className: "p-2" },
                        b.status === "pending" && React.createElement("div", null,
                          React.createElement("button", {
                            className: "bg-green-600 text-white px-2 py-1 rounded mr-2 hover:bg-green-700",
                            onClick: () => handleStatus(b.id, "confirmed")
                          }, "Confirm"),
                          React.createElement("button", {
                            className: "bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",
                            onClick: () => handleCancel(b.id)
                          }, "Cancel")
                        ),
                        b.status === "confirmed" && React.createElement("div", null,
                          React.createElement("button", {
                            className: "bg-blue-600 text-white px-2 py-1 rounded mr-2 hover:bg-blue-700",
                            onClick: () => setEditBooking(b)
                          }, "Edit"),
                          React.createElement("button", {
                            className: "bg-red-600 text-white px-2 py-1 rounded hover:bg-red-700",
                            onClick: () => handleCancel(b.id)
                          }, "Cancel")
                        )
                      )
                    )
                  )
                )
              )
        )
      );
    }

    // --- EditBookingModal: Modal for editing confirmed booking ---
    function EditBookingModal({ booking, onSave, onCancel }) {
      const [date, setDate] = useState(booking.date);
      const [startTime, setStartTime] = useState(booking.startTime);
      const [endTime, setEndTime] = useState(booking.endTime);
      const [plan, setPlan] = useState(booking.plan);
      const [error, setError] = useState("");

      const duration = useMemo(() => {
        if (!startTime || !endTime) return 0;
        return parseInt(endTime.split(':')[0], 10) - parseInt(startTime.split(':')[0], 10);
      }, [startTime, endTime]);

      function handleSubmit(e) {
        e.preventDefault();
        setError("");
        if (!date || !startTime || !endTime || !plan) {
          setError("Please fill all fields.");
          return;
        }
        if (duration <= 0) {
          setError("End time must be after start time.");
          return;
        }
        onSave({ ...booking, date, startTime, endTime, plan });
      }

      return (
        React.createElement("div", { className: "fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4" },
          React.createElement("div", { className: "bg-zinc-800 p-6 rounded-2xl shadow-2xl border border-zinc-700 w-full max-w-md relative" },
            React.createElement("button", { onClick: onCancel, className: "absolute top-3 right-4 text-gray-400 hover:text-white transition-colors text-3xl font-light" }, "×"),
            React.createElement("h2", { className: "text-xl font-bold mb-4 text-white" }, "Edit Booking"),
            React.createElement("form", { onSubmit: handleSubmit },
              React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "Date"),
              React.createElement("input", { type: "date", className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: date, onChange: e => setDate(e.target.value), min: new Date().toISOString().split('T')[0] }),
              React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "Start Time"),
              React.createElement("select", { className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: startTime, onChange: e => setStartTime(e.target.value) },
                React.createElement("option", { value: "" }, "Select start time"),
                HOURLY_SLOTS.slice(0, -1).map(time =>
                  React.createElement("option", { key: time, value: time }, time)
                )
              ),
              React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "End Time"),
              React.createElement("select", { className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: endTime, onChange: e => setEndTime(e.target.value) },
                React.createElement("option", { value: "" }, "Select end time"),
                HOURLY_SLOTS.map(time =>
                  React.createElement("option", { key: time, value: time }, time)
                )
              ),
              React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "Plan"),
              React.createElement("select", { className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: plan, onChange: e => setPlan(e.target.value) },
                PRICING_PLANS.map(p =>
                  React.createElement("option", { key: p.name, value: p.name }, p.name)
                )
              ),
              error && React.createElement("div", { className: "mb-2 text-red-400" }, error),
              React.createElement("div", { className: "flex space-x-4" },
                React.createElement("button", { type: "submit", className: "bg-blue-500 text-white font-bold py-2 px-6 rounded hover:bg-blue-600 transition-colors" }, "Save"),
                React.createElement("button", { type: "button", className: "bg-zinc-600 text-white font-bold py-2 px-6 rounded hover:bg-zinc-700 transition-colors", onClick: onCancel }, "Cancel")
              )
            )
          )
        )
      );
    }

    function App() {
      const [selectedPlan, setSelectedPlan] = useState(null);
      const [isAuthenticated, setIsAuthenticated] = useState(false);

      return (
        React.createElement(BrowserRouter, null,
          React.createElement(Header, { isAuthenticated, logout: () => setIsAuthenticated(false) }),
          React.createElement("main", null,
            React.createElement(Switch, null,
              React.createElement(Route, { exact: true, path: "/" },
                !selectedPlan ? (
                  React.createElement(Pricing, { onSelectPlan: setSelectedPlan })
                ) : (
                  React.createElement(BookingForm, {
                    plan: selectedPlan,
                    onCancel: () => setSelectedPlan(null)
                  })
                )
              ),
              React.createElement(Route, { path: "/admin" },
                React.createElement(AdminPanel, { isAuthenticated, setIsAuthenticated })
              ),
              React.createElement(Route, { render: () => React.createElement(Redirect, { to: "/" }) })
            )
          ),
          React.createElement(Footer)
        )
      );
    }

    ReactDOM.render(
      React.createElement(App),
      document.getElementById('root')
    );
  </script>
</body>
</html>
