<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Posibble Studio Booking</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
  </style>
  <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/react-router-dom@5.3.4/umd/react-router-dom.min.js"></script>
</head>
<body class="bg-zinc-900 text-white">
  <div id="root"></div>
  <script>
const { useState, useEffect, useMemo, useCallback } = React;
const { BrowserRouter, Route, Switch, Link, useHistory, Redirect, useLocation } = ReactRouterDOM;

// --- Constants ---
const PRICING_PLANS = [
  { id: 'basic', name: 'Basic Studio', price: 2000, description: 'Just the space. Bring your own gear and create freely.', features: ['Studio Space Access'] },
  { id: 'standard', name: 'Standard Package', price: 3500, description: 'A complete setup for most projects, cameraman included.', features: ['Studio Space Access', '2 Professional Cameras', 'Standard Lighting Kit', '2 Shure Microphones', 'Dedicated Cameraman'] },
  { id: 'premium', name: 'Premium Package', price: 4500, description: 'For complex shoots requiring multiple angles and full support.', features: ['Studio Space Access', '3 Professional Cameras', 'Advanced Lighting Kit', '2 Shure Microphones', 'Dedicated Cameraman'] },
];
const HOURLY_SLOTS = Array.from({ length: 14 }, (_, i) => {
  const hour = i + 9;
  return `${hour < 10 ? '0' : ''}${hour}:00`;
});

// --- Header ---
function Header({ isAuthenticated, logout }) {
  const location = useLocation();
  return (
    React.createElement("header", { className: "bg-zinc-900/80 backdrop-blur-sm sticky top-0 z-40" },
      React.createElement("div", { className: "container mx-auto px-4 sm:px-6 lg:px-8" },
        React.createElement("div", { className: "flex items-center justify-between h-16" },
          React.createElement(Link, { to: "/", className: "flex items-center" },
            React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: "h-8 w-8 text-yellow-400", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
              React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7H4a2 2 0 00-2 2v6a2 2 0 002 2h16a2 2 0 002-2V9a2 2 0 00-2-2z" })
            ),
            React.createElement("span", { className: "ml-3 text-2xl font-bold text-white" }, "Posibble Studio")
          ),
          React.createElement("div", { className: "flex items-center space-x-4" },
            isAuthenticated && location.pathname === "/admin" ? (
              React.createElement("button", {
                onClick: logout,
                className: "px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 transition-colors"
              }, "Logout")
            ) : (
              React.createElement(Link, {
                to: "/admin",
                className: "px-4 py-2 text-sm font-medium text-white bg-zinc-700 rounded-md hover:bg-yellow-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75 transition-colors"
              }, "Admin Panel")
            )
          )
        )
      )
    )
  );
}

// --- Footer ---
function Footer() {
  return (
    React.createElement("footer", { className: "bg-zinc-800 border-t border-zinc-700 mt-16" },
      React.createElement("div", { className: "container mx-auto px-4 sm:px-6 lg:px-8 py-8" },
        React.createElement("div", { className: "text-center text-gray-400" },
          React.createElement("p", null, `© ${new Date().getFullYear()} Posibble Studio. All Rights Reserved.`),
          React.createElement("p", { className: "mt-2 text-sm" }, "Built for creative professionals."),
          React.createElement("div", { className: "mt-4 flex justify-center space-x-6" },
            React.createElement("a", { href: "#", className: "hover:text-yellow-400 transition-colors" }, "Instagram"),
            React.createElement("a", { href: "#", className: "hover:text-yellow-400 transition-colors" }, "Facebook"),
            React.createElement("a", { href: "#", className: "hover:text-yellow-400 transition-colors" }, "Twitter")
          )
        )
      )
    )
  );
}

// --- Pricing ---
function CheckIcon() {
  return (
    React.createElement("svg", { className: "h-6 w-6 text-yellow-400", xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
      React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: "2", d: "M5 13l4 4L19 7" })
    )
  );
}
function PhoneIcon() {
  return (
    React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", className: "h-6 w-6 text-yellow-400", fill: "none", viewBox: "0 0 24 24", stroke: "currentColor" },
      React.createElement("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" })
    )
  );
}
function PricingCard({ plan, onSelect }) {
  return (
    React.createElement("div", { className: `flex flex-col h-full bg-zinc-800 rounded-2xl shadow-xl border border-zinc-700 p-8 transform transition-transform duration-300 hover:-translate-y-2 ${plan.id === 'standard' ? 'border-yellow-500 ring-2 ring-yellow-500' : ''}` },
      React.createElement("h3", { className: "text-2xl font-bold text-white" }, plan.name),
      React.createElement("p", { className: "mt-4 text-gray-400 flex-grow" }, plan.description),
      React.createElement("div", { className: "mt-6" },
        React.createElement("span", { className: "text-5xl font-extrabold text-white" }, `₹${plan.price.toLocaleString('en-IN')}`),
        React.createElement("span", { className: "text-lg font-medium text-gray-400" }, "/hour")
      ),
      React.createElement("ul", { className: "mt-8 space-y-4" },
        plan.features.map((feature, index) =>
          React.createElement("li", { key: index, className: "flex items-start" },
            React.createElement("div", { className: "flex-shrink-0" }, React.createElement(CheckIcon)),
            React.createElement("p", { className: "ml-3 text-base text-gray-300" }, feature)
          )
        )
      ),
      React.createElement("div", { className: "mt-auto pt-8" },
        React.createElement("button", {
          onClick: onSelect,
          className: "w-full bg-yellow-500 text-slate-900 font-bold py-3 px-6 rounded-lg hover:bg-yellow-600 transition-colors"
        }, "Select Plan")
      )
    )
  );
}
function Pricing({ onSelectPlan }) {
  return (
    React.createElement("section", { id: "pricing-section", className: "py-20 sm:py-28 bg-zinc-900" },
      React.createElement("div", { className: "container mx-auto px-4 sm:px-6 lg:px-8" },
        React.createElement("div", { className: "text-center mb-16" },
          React.createElement("h2", { className: "text-3xl sm:text-4xl lg:text-5xl font-bold tracking-tight text-white" }, "Flexible Pricing for Every Creator"),
          React.createElement("p", { className: "mt-4 max-w-3xl mx-auto text-lg text-gray-400" },
            "Choose a standard package or call us to build a custom one. All prices are inclusive of taxes."
          )
        ),
        React.createElement("div", { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 items-stretch" },
          PRICING_PLANS.map((plan) =>
            React.createElement(PricingCard, { key: plan.id, plan, onSelect: () => onSelectPlan(plan) })
          ),
          React.createElement("div", { className: "flex flex-col h-full bg-zinc-800 rounded-2xl shadow-xl border border-dashed border-zinc-600 p-8 transform transition-transform duration-300 hover:-translate-y-2" },
            React.createElement("h3", { className: "text-2xl font-bold text-white" }, "Custom Package"),
            React.createElement("p", { className: "mt-4 text-gray-400 flex-grow" }, "Need something different? Let's build a package that fits your exact needs."),
            React.createElement("div", { className: "mt-6" },
              React.createElement("span", { className: "text-4xl font-extrabold text-white" }, "Tailored Pricing"),
              React.createElement("p", { className: "text-lg font-medium text-gray-400" }, "Call for a quote")
            ),
            React.createElement("ul", { className: "mt-8 space-y-4" },
              React.createElement("li", { className: "flex items-start" },
                React.createElement("div", { className: "flex-shrink-0" }, React.createElement(PhoneIcon)),
                React.createElement("p", { className: "ml-3 text-base text-gray-300" }, "Custom equipment list")
              ),
              React.createElement("li", { className: "flex items-start" },
                React.createElement("div", { className: "flex-shrink-0" }, React.createElement(PhoneIcon)),
                React.createElement("p", { className: "ml-3 text-base text-gray-300" }, "Multi-day or long-term rental")
              ),
              React.createElement("li", { className: "flex items-start" },
                React.createElement("div", { className: "flex-shrink-0" }, React.createElement(PhoneIcon)),
                React.createElement("p", { className: "ml-3 text-base text-gray-300" }, "Specialist crew members")
              )
            ),
            React.createElement("div", { className: "mt-auto pt-8" },
              React.createElement("a", {
                href: "tel:+919994858927",
                className: "w-full block text-center bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 transition-colors"
              }, "Call to Book")
            )
          )
        )
      )
    )
  );
}

// --- BookingForm ---
function BookingForm({ plan, addBooking, bookings, getUnavailableHours, onCancel }) {
  const [date, setDate] = useState(new Date().toISOString().split('T')[0]);
  const [startTime, setStartTime] = useState('');
  const [endTime, setEndTime] = useState('');
  const [paymentOption, setPaymentOption] = useState('full');
  const [name, setName] = useState('');
  const [phone, setPhone] = useState('');
  const [formError, setFormError] = useState('');
  const [showUpiModal, setShowUpiModal] = useState(false);
  const [pendingBooking, setPendingBooking] = useState(null);

  useEffect(() => { setStartTime(''); setEndTime(''); }, [date]);
  useEffect(() => { setEndTime(''); }, [startTime]);

  // --- Storage event listener for booking confirmation ---
  useEffect(() => {
    function onStorageChange(e) {
      if (e.key === 'studioBookings' && pendingBooking) {
        const updatedBookings = JSON.parse(e.newValue || '[]');
        const updatedBooking = updatedBookings.find(b => b.id === pendingBooking.id);
        if (updatedBooking && updatedBooking.status === 'confirmed') {
          setShowUpiModal(false);
          setPendingBooking(null);
        }
      }
    }
    window.addEventListener('storage', onStorageChange);
    return () => window.removeEventListener('storage', onStorageChange);
  }, [pendingBooking]);

  // Also check for updates in bookings prop (for same-tab admin action)
  useEffect(() => {
    if (pendingBooking) {
      const updatedBooking = bookings.find(b => b.id === pendingBooking.id);
      if (updatedBooking && updatedBooking.status === 'confirmed') {
        setShowUpiModal(false);
        setPendingBooking(null);
      }
    }
  }, [bookings, pendingBooking]);

  const unavailableHours = useMemo(() => getUnavailableHours(date), [date, getUnavailableHours]);
  const startTimes = useMemo(() => HOURLY_SLOTS.slice(0, -1).map(time => ({ value: time, disabled: unavailableHours.includes(parseInt(time.split(':')[0], 10)) })), [unavailableHours]);
  const endTimes = useMemo(() => {
    if (!startTime) return [];
    const startHour = parseInt(startTime.split(':')[0], 10);
    let nextUnavailableHour = 23;
    for (const hour of unavailableHours.sort((a,b) => a - b)) { if (hour > startHour) { nextUnavailableHour = hour; break; } }
    return HOURLY_SLOTS.map(time => parseInt(time.split(':')[0], 10)).filter(hour => hour > startHour && hour <= nextUnavailableHour).map(hour => ({ value: `${hour < 10 ? '0' : ''}${hour}:00` }));
  }, [startTime, unavailableHours]);
  const duration = useMemo(() => {
    if (!startTime || !endTime) return 0;
    return parseInt(endTime.split(':')[0], 10) - parseInt(startTime.split(':')[0], 10);
  }, [startTime, endTime]);
  const totalAmount = plan.price * duration;
  const paymentAmount = paymentOption === "full" ? totalAmount : Math.ceil(totalAmount / 2);

  const handleSubmit = (e) => {
    e.preventDefault();
    setFormError('');
    if (!name || !phone || !date || !startTime || !endTime) {
      setFormError('Please fill all fields.');
      return;
    }
    if (duration <= 0) {
      setFormError('End time must be after start time.');
      return;
    }
    // Check for booking conflicts
    const startHour = parseInt(startTime.split(':')[0], 10);
    const endHour = parseInt(endTime.split(':')[0], 10);
    for (let hour = startHour; hour < endHour; hour++) {
      if (unavailableHours.includes(hour)) {
        setFormError('Selected time slot is not available.');
        return;
      }
    }
    // Create booking object
    const booking = {
      id: Math.random().toString(36).substr(2, 8).toUpperCase(),
      name,
      phone,
      plan: plan.name,
      date,
      startTime,
      endTime,
      status: 'pending',
      amount: totalAmount,
      paid: paymentOption === "full" ? totalAmount : paymentAmount,
      paymentOption,
      createdAt: new Date().toISOString(),
    };
    setPendingBooking(booking);
    setShowUpiModal(true);
  };

  return (
    React.createElement("div", { className: "max-w-lg mx-auto bg-zinc-800 rounded-xl shadow-lg p-8 border border-zinc-700" },
      React.createElement("h2", { className: "text-2xl font-bold mb-6 text-white" }, `Book ${plan.name}`),
      React.createElement("form", { onSubmit: handleSubmit },
        React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "Your Name"),
        React.createElement("input", { className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: name, onChange: e => setName(e.target.value) }),
        React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "Phone Number"),
        React.createElement("input", { className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: phone, onChange: e => setPhone(e.target.value) }),
        React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "Date"),
        React.createElement("input", { type: "date", className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: date, onChange: e => setDate(e.target.value), min: new Date().toISOString().split('T')[0] }),
        React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "Start Time"),
        React.createElement("select", { className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: startTime, onChange: e => setStartTime(e.target.value) },
          React.createElement("option", { value: "" }, "Select start time"),
          startTimes.map(({ value, disabled }) =>
            React.createElement("option", { key: value, value, disabled }, value)
          )
        ),
        React.createElement("label", { className: "block mb-2 text-sm font-medium text-gray-300" }, "End Time"),
        React.createElement("select", { className: "w-full mb-4 p-2 rounded bg-zinc-700 text-white", value: endTime, onChange: e => setEndTime(e.target.value) },
          React.createElement("option", { value: "" }, "Select end time"),
          endTimes.map(({ value }) =>
            React.createElement("option", { key: value, value }, value)
          )
        ),
        React.createElement("div", { className: "mb-4" },
          React.createElement("span", { className: "text-gray-300" }, "Payment Option: "),
          React.createElement("label", { className: "ml-2" },
            React.createElement("input", { type: "radio", value: "full", checked: paymentOption === "full", onChange: () => setPaymentOption('full') }),
            React.createElement("span", { className: "ml-1" }, "Full")
          ),
          React.createElement("label", { className: "ml-4" },
            React.createElement("input", { type: "radio", value: "half", checked: paymentOption === "half", onChange: () => setPaymentOption('half') }),
            React.createElement("span", { className: "ml-1" }, "50% Advance")
          )
        ),
        React.createElement("div", { className: "mb-4" },
          React.createElement("span", { className: "text-gray-300" }, "Total: "),
          React.createElement("span", { className: "text-yellow-400 font-bold text-lg" }, `₹${totalAmount.toLocaleString('en-IN')}`),
          paymentOption === "half" && React.createElement("span", { className: "ml-2 text-green-400" }, `(Pay ₹${paymentAmount} now)`)
        ),
        formError && React.createElement("div", { className: "mb-4 text-red-400" }, formError),
        React.createElement("div", { className: "flex space-x-4" },
          React.createElement("button", { type: "submit", class
